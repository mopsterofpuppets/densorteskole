<!DOCTYPE html>
<html lang="da">
<head>
<meta charset="UTF-8">
<title>Join spillet â€“ Den Sorte Skole</title>
<link href="https://fonts.googleapis.com/css2?family=Metal+Mania&display=swap" rel="stylesheet">
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>
<script src="firebase_c.js"></script>
<style>
body {
  margin:0; background:black; color:white;
  font-family:'Metal Mania', cursive;
  text-align:center;
  background:url('background.jpg') no-repeat center center fixed;
  background-size:cover;
}
h1 { font-size:3em; margin:20px; color:#ff0000;
     text-shadow:
     0 0 5px #660000,
     0 0 10px #990000,
     0 0 20px #cc0000,
     0 0 30px #ff0000,
     0 0 40px #ff3300,
     0 0 50px #ff3300,
     0 0 60px #ff6600;}
input {
  font-size:1.5em; padding:10px; margin:20px;
  border-radius:8px; border:2px solid red;
}
button {
  background:darkred; color:white; font-size:1.5em;
  padding:10px 20px; border:none; cursor:pointer;
  border-radius:10px; box-shadow:0 0 15px red;
}
button:hover { background:#b30000; }
</style>
</head>
<body>
<h1>Join spillet</h1>
<p>Indtast dit holdnavn:</p>
<input id="teamName" maxlength="25" placeholder="Holdnavn"><br>
<button id="joinBtn">Join</button>

<script>
// Hent gameID fra URL
const urlParams = new URLSearchParams(window.location.search);
const gameId = urlParams.get('game');

if(!gameId){
  alert("Fejl: gameId ikke fundet i URL!");
} else {
  localStorage.setItem("gameId", gameId);
}

const joinBtn=document.getElementById('joinBtn');

joinBtn.addEventListener('click', ()=>{
  const name = document.getElementById('teamName').value.trim();
  if(!name) return alert("Indtast holdnavn!");

  const teamRef = db.ref(gameId + "/teams").push();
  teamRef.set({ name:name, points:0, buzzed:false })
    .then(()=>{
      localStorage.setItem("teamId", teamRef.key);
      localStorage.setItem("teamName", name);
      window.location.href="waiting.htm?game=" + gameId;
    })
    .catch(err=>{
      alert("Fejl ved tilmelding: " + err);
      console.error("Firebase fejl:", err);
    });
});
</script>
</body>
</html>
